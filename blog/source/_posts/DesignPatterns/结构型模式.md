---
title: 结构型模式
---

# 转换接口的适配器 -- Adapter
将一个类的接口转换成客户希望的另外一个接口，Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。

## 适用性
以下情况使用Adapter模式：
- 使用一个已经存在的类，而它的接口不符合需求
- 创建一个可复用的类，该类可以与其他不相关的类或不可预见的类协同工作
- 想使用一些已经存在的子类，但是不可能对每一个都进行子类化以匹配他们的接口，对象适配器可以适配它的父类接口

## 结构
类适配器使用多重继承对一个接口与另一个接口进行匹配：
{%raw%}
<svg xmlns="http://www.w3.org/2000/svg" viewBox="215.840909090909 46.0 662.3409090909091 269.1089406461307"><defs><marker id="a" markerUnits="userSpaceOnUse" orient="auto" markerWidth="16.236" markerHeight="10.551" viewBox="-1.0 -1.3763819204711736 16.23606797749979 10.550836550532098" refX="-1" refY="3.899"><path d="M12 3.9L0 7.797V0z" stroke="#323232" stroke-width="2" fill="#fff"/></marker><marker id="b" markerUnits="userSpaceOnUse" orient="auto" markerWidth="16.236" markerHeight="10.551" viewBox="-1.0 -1.3763819204711736 16.23606797749979 10.550836550532098" refX="-1" refY="3.899"><path d="M12 3.9L0 7.797V0z" stroke="#323232" stroke-width="2" fill="#fff"/></marker><marker id="c" markerUnits="userSpaceOnUse" orient="auto" markerWidth="16.236" markerHeight="10.551" viewBox="-1.0 -1.3763819204711736 16.23606797749979 10.550836550532098" refX="-1" refY="3.899"><path d="M12 3.9L0 7.797V0z" stroke="#323232" stroke-width="2" fill="#323232"/></marker><marker id="d" markerUnits="userSpaceOnUse" orient="auto" markerWidth="10" markerHeight="10" viewBox="-1.0 -1.0 10.0 10.0" refX="8" refY="4"><path d="M0 4a4 4 0 0 1 4-4 4 4 0 1 1-4 4" stroke="#323232" stroke-width="2" fill="#fff"/></marker></defs><path d="M215.84 46h662.342v269.11h-662.34V46z" fill="none"/><path d="M403 70q0-4 4-4h98q4 0 4 4v56q0 4-4 4h-98q-4 0-4-4z" stroke="#323232" stroke-width="2" fill="#9cf"/><path d="M403 96h106" stroke="#323232" stroke-width="2" fill="none"/><path d="M403 66h106v64H403z" fill="none"/><text fill="#323232" font-size="15" x="42" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(413 71.625)">Target</text><text fill="#323232" font-size="15" x="42" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(413 103.625)">request()</text><path d="M586 70q0-4 4-4h150q4 0 4 4v56q0 4-4 4H590q-4 0-4-4z" stroke="#323232" stroke-width="2" fill="#9cf"/><path d="M586 96h158" stroke="#323232" stroke-width="2" fill="none"/><path d="M586 66h158v64H586z" fill="none"/><text fill="#323232" font-size="15" x="68" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(596 71.625)">Adaptee</text><text fill="#323232" font-size="15" x="68" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(596 103.625)">specificRequest()</text><g><path d="M472 231q0-4 4-4h161q4 0 4 4v60q0 4-4 4H476q-4 0-4-4z" stroke="#323232" stroke-width="2" fill="#f5927b"/><path d="M472 257h169" stroke="#323232" stroke-width="2" fill="none"/><path d="M472 227h169v68H472z" fill="none"/><text fill="#323232" font-size="15" x="73.5" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(482 232.625)">Adapter</text><text fill="#323232" font-size="15" x="73.5" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(482 266.625)">request()</text></g><g><path d="M556.5 227v-48.5H456v-33.264" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#a)"/></g><g><path d="M556.5 227v-48.5H665v-33.264" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#b)"/></g><g><path d="M235.84 71.637q0-4 4-4h85q4 0 4 4v37q0 4-4 4h-85q-4 0-4-4z" stroke="#323232" stroke-width="2" fill="#f5927b"/><text fill="#323232" font-size="15" x="35.5" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(245.84 80.762)">Client</text></g><g><path d="M328.84 90.137h37.08V90h21.844" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#c)"/></g><g><path d="M716.364 254.654h125.818l16 16v24.455H716.364v-40.456z" stroke="#323232" stroke-width="2" fill="#f5927b"/><path d="M842.182 254.654v16h16" stroke="#323232" stroke-width="2" fill="#f5927b"/><path d="M716.364 254.654h125.818l16 16v24.455H716.364v-40.456z" stroke="#323232" stroke-width="2" fill="none"/><text fill="#323232" font-size="13" x="59.909" y="13.325" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(726.364 266.757)">specificRequest()</text></g><g><path d="M607.687 278.182h108.98" stroke="#323232" stroke-width="2" fill="none" marker-start="url(#d)"/></g></svg>
{%endraw%}

对象匹配器依赖于对象组合：
{%raw%}
<svg xmlns="http://www.w3.org/2000/svg" viewBox="215.840909090909 46.0 569.4532085561497 295.17647058823513" width="100%" height="100%"><defs><marker id="a" markerUnits="userSpaceOnUse" orient="auto" markerWidth="16.236" markerHeight="10.551" viewBox="-1.0 -1.3763819204711736 16.23606797749979 10.550836550532098" refX="-1" refY="3.899"><path d="M12 3.9L0 7.797V0z" stroke="#323232" stroke-width="2" fill="#fff"/></marker><marker id="b" markerUnits="userSpaceOnUse" orient="auto" markerWidth="16.236" markerHeight="10.551" viewBox="-1.0 -1.3763819204711736 16.23606797749979 10.550836550532098" refX="-1" refY="3.899"><path d="M12 3.9L0 7.797V0z" stroke="#323232" stroke-width="2" fill="#323232"/></marker><marker id="c" markerUnits="userSpaceOnUse" orient="auto" markerWidth="10" markerHeight="10" viewBox="-1.0 -1.0 10.0 10.0" refX="8" refY="4"><path d="M0 4a4 4 0 0 1 4-4 4 4 0 1 1-4 4" stroke="#323232" stroke-width="2" fill="#fff"/></marker><marker id="d" markerUnits="userSpaceOnUse" orient="auto" markerWidth="20.61" markerHeight="10.888" viewBox="-2.3047648709624866 -1.5914908829822711 20.609529741924973 10.888175666885001" refX="16" refY="3.853"><path d="M0 3.853L8 0l8 3.853-8 3.852z" stroke="#323232" stroke-width="2" fill="#fff"/></marker><marker id="e" markerUnits="userSpaceOnUse" orient="auto" markerWidth="16.236" markerHeight="10.551" viewBox="-1.0 -1.3763819204711736 16.23606797749979 10.550836550532098" refX="-1" refY="3.899"><path d="M12 3.9L0 7.797V0z" stroke="#323232" stroke-width="2" fill="#323232"/></marker></defs><path d="M215.84 46h569.454v295.176H215.84V46z" fill="none"/><path d="M403 70q0-4 4-4h98q4 0 4 4v56q0 4-4 4h-98q-4 0-4-4z" stroke="#323232" stroke-width="2" fill="#9cf"/><path d="M403 96h106" stroke="#323232" stroke-width="2" fill="none"/><path d="M403 66h106v64H403z" fill="none"/><text fill="#323232" font-size="15" x="42" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(413 71.625)">Target</text><text fill="#323232" font-size="15" x="42" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(413 103.625)">request()</text><path d="M578.94 168.235q0-4 4-4h150q4 0 4 4v56q0 4-4 4h-150q-4 0-4-4z" stroke="#323232" stroke-width="2" fill="#9cf"/><path d="M578.94 194.235h158" stroke="#323232" stroke-width="2" fill="none"/><path d="M578.94 164.235h158v64h-158z" fill="none"/><text fill="#323232" font-size="15" x="68" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(588.94 169.86)">Adaptee</text><text fill="#323232" font-size="15" x="68" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(588.94 201.86)">specificRequest()</text><g><path d="M455.912 227.12v-48.56H456v-33.324" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#a)"/></g><g><path d="M235.84 71.637q0-4 4-4h85q4 0 4 4v37q0 4-4 4h-85q-4 0-4-4z" stroke="#323232" stroke-width="2" fill="#f5927b"/><text fill="#323232" font-size="15" x="35.5" y="15.375" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(245.84 80.762)">Client</text></g><g><path d="M328.84 90.137h37.08V90h21.844" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#b)"/></g><g><path d="M578.128 286.42h171.166l16 16v18.756H578.128V286.42z" stroke="#323232" stroke-width="2" fill="#f5927b"/><path d="M749.294 286.42v16h16" stroke="#323232" stroke-width="2" fill="#f5927b"/><path d="M578.128 286.42h171.166l16 16v18.756H578.128V286.42z" stroke="#323232" stroke-width="2" fill="none"/><text fill="#323232" font-size="13" x="82.583" y="13.325" font-family="Arial" text-anchor="middle" transform="translate(588.128 295.673)">adaptee.specificRequest()</text></g><g><path d="M391.47 230.176q0-4 4-4H516q4 0 4 4v82.883q0 4-4 4H395.47q-4 0-4-4z" stroke="#323232" stroke-width="2" fill="#f5927b"/><path d="M391.47 256.176H520m-128.53 32H520" stroke="#323232" stroke-width="2" fill="none"/><path d="M391.47 226.176H520v90.883H391.47z" fill="none"/><text fill="#323232" font-size="13" x="53.265" y="13.325" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(401.47 233.05)">Adapter</text><text fill="#323232" font-size="13" x="53.265" y="13.325" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(401.47 263.05)">adaptee</text><text fill="#323232" font-size="13" x="53.265" y="13.325" font-family="Arial" font-weight="bold" text-anchor="middle" transform="translate(401.47 295.05)">request()</text></g><g><path d="M505.334 304.064H577.647" stroke="#323232" stroke-width="2" fill="none" marker-start="url(#c)"/></g><g><path d="M538.305 271.618h11.166v-75.383h14.235" stroke="#323232" stroke-width="2" fill="none" marker-start="url(#d)" marker-end="url(#e)"/></g></svg>
{%endraw%}

## 参与者
- Target: 定义Client使用的与特定领域相关的接口
- Client: 与符合 Target 接口的对象协同
- Adaptee: 定义一个已经存在的接口，这个接口需要适配
- Adapter: 对Adaptee 的接口与 Target 接口进行适配

## 效果
类适配器和对象适配器有不同的权衡，其中类适配器：
- 用一个具体的Adapter类对Adaptee和Target进行匹配，结果是当我们想要匹配一个类以及它的所有子类时，类Adapter将不能胜任工作。
- 使得Adapter可以重定义Adaptee的部分行为，因为Adapter是Adaptee的一个子类
- 仅仅引入了一个对象，并不需要额外的指针以间接得到adaptee

对象适配器：
- 允许一个Adapter与多个Adaptee（Adaptee以及其子类）一同工作。Adapter也可以一次给所有的Adaptee添加功能
- 使得重定义Adaptee的行为比较困难。这就需要生成Adaptee的子类并且使得Adapter引用这个子类而不是引用Adaptee本身 (作为参数传递)

使用适配器模式需要考虑的因素：
- **Adapter的匹配程度**。 对Adaptee的接口与Target的接口进行匹配的工作量，各个Adapter可能不一样。可能从简单的接口转换到支持完全不同操作集合
- **可插入Adapter**。 当其他类使用一个类时，所需的假定条件越少，就具有越高的可复用性。
- **使用双向适配器提供透明操作**。 被适配的对象不再兼容Adaptee的接口，因此并不是所有Adaptee对象可以被使用的地方它都可以被使用，双向适配器可以提供这样的透明性（接口）。


